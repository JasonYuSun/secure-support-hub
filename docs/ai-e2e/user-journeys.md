# Autonomous E2E User Journeys

## Assumptions and Spec Drift
- **Attachments**: The README lists "Attachments backed by S3" under Phase 2, but the required testing specs mandate verifying attachment constraints, uploads, and downloads. We will assume attachments are fully implemented and must be tested.
- **AI Assist**: The README mentions "AI Assist" under Phase 2. Since it is absent from the testing prompt's mandatory checks, we will omit it from our core E2E user journeys.
- **Source of Truth**: The README serves as the primary source for features and roles, while the prompt provides exact constraints for attachments, state transitions, and UI routes.
- **Environment**: Using local or provided remote environment.

## Journey Catalog

| Journey ID | Feature         | Role   | Scenario                              | Preconditions                        | Steps (high-level)                                                                                                     | Expected Result                                                                                     | Priority | Risk |
| ---------- | --------------- | ------ | ------------------------------------- | ------------------------------------ | ---------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- | -------- | ---- |
| J-001      | Auth & Request  | USER   | Happy Path: Create request & comment  | Has USER account, logged out         | 1. Login. 2. Navigate to /requests/new. 3. Submit request. 4. Add comment.                                             | Request created, comment visible, lands on /requests/{id}.                                          | P0       | H    |
| J-002      | Triage Workflow | TRIAGE | Happy Path: Assign & update status    | Has TRIAGE account, existing request | 1. Login. 2. View /triage. 3. Open request. 4. Assign to self. 5. Update status (e.g. to IN_PROGRESS). 6. Add comment. | Assignee updated, status changed, comment visible.                                                  | P0       | H    |
| J-003      | Admin Mgmt      | ADMIN  | Happy Path: View users & change roles | Has ADMIN account, other user exists | 1. Login. 2. View /admin/users. 3. Change a user's role.                                                               | Role updated successfully in UI.                                                                    | P0       | H    |
| J-004      | RBAC Negative   | USER   | Prevent access to privileged routes   | Has USER account, logged in          | 1. Navigate to /triage. 2. Navigate to /admin/users. 3. Attempt status/assignee update via UI.                         | Redirected to /, update controls unavailable.                                                       | P1       | M    |
| J-005      | RBAC Negative   | TRIAGE | Prevent access to admin routes        | Has TRIAGE account, logged in        | 1. Navigate to /admin/users.                                                                                           | Redirected to /.                                                                                    | P1       | M    |
| J-006      | Guardrails      | ADMIN  | Prevent self-demotion                 | Has ADMIN account, logged in         | 1. View /admin/users. 2. Find self ('admin'). 3. Attempt role change.                                                  | Role selector is disabled for self.                                                                 | P1       | M    |
| J-007      | Auth Redirects  | Unauth | Redirect to login                     | Logged out                           | 1. Navigate to /. 2. Navigate to /triage.                                                                              | Redirected to /login.                                                                               | P1       | M    |
| J-008      | Validation      | USER   | Required fields on creation           | Has USER account, logged in          | 1. Navigate to /requests/new. 2. Submit empty form.                                                                    | Validation errors shown, request not created.                                                       | P1       | M    |
| J-009      | Validation      | Any    | Invalid login                         | Logged out                           | 1. Navigate to /login. 2. Enter bad credentials.                                                                       | Login rejected, error shown.                                                                        | P1       | M    |
| J-010      | State Machine   | TRIAGE | Invalid status transitions            | Has TRIAGE account, logged in        | 1. Open CLOSED request. 2. Attempt to change status.                                                                   | Status change controls disabled/hidden or rejected.                                                 | P1       | M    |
| J-011      | Attachments     | USER   | Happy Path: Upload, download, delete  | Has USER account, logged in          | 1. Create request with attachment. 2. Add comment with attachment. 3. Download attachment. 4. Delete attachment.       | Uploads succeed, download triggers /download-url, deletion succeeds.                                | P2       | L    |
| J-012      | Attachments     | USER   | Bound checks (Type, Size, Max)        | Has USER account, logged in          | 1. Upload invalid type. 2. Upload oversized file (>10MiB). 3. Exceed max count (10 req, 5 comment).                    | Error messages shown ("File type is not allowed", "File is too large", "Attachment limit reached"). | P2       | L    |
| J-013      | Deletion        | USER   | Delete own request & comment          | Has USER account, logged in          | 1. Open own request. 2. Delete comment. 3. Delete request.                                                             | Item successfully deleted and removed from UI.                                                      | P1       | M    |
